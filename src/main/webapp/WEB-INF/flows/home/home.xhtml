<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core" 
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/layouts/standard.xhtml">
                
<ui:define name="entry-point-scripts">
<script>
//<![CDATA[
$(document).ready(function() {
    $("#fragment-group").on("mouseenter", ".each-fragment-container", function() {
   		$(this).find(".fragment-menu").show();
   	});
    
    $("#fragment-group").on("mouseleave", ".each-fragment-container", function() {
   		$(this).find(".fragment-menu").hide();
   	});
    
    $(".fragment-content").each(function(){
    	var $this = $(this);
        var content = $this.text();
   	    $this.html(parseMarkdown(content));
   	});
    
    var fragmentCheckboxMaster = PF("fragmentCheckboxMaster");
    var fragmentCheckboxSlaves = [];    
    var cbSlaveCount = $("#fragment-group .each-fragment-container").length;
    
    for (var i=0; i<cbSlaveCount; ++i) {
        var cb = PrimeFaces.widgets["fragmentCheckboxSlave" + i];
        fragmentCheckboxSlaves.push(cb);
    }

    var fragmentCheckboxMaster = PF("fragmentCheckboxMaster");
    
    fragmentCheckboxMaster.getJQ().click(function (e) {
        if (fragmentCheckboxMaster.isChecked()) {
	        for (var i=0; i<cbSlaveCount; ++i) {
	            fragmentCheckboxSlaves[i].check();
	        }
        }
        else {
	        for (var i=0; i<cbSlaveCount; ++i) {
                fragmentCheckboxSlaves[i].uncheck();
            }
        }
    });
}); // end of $(document).ready()
//]]>
</script>
</ui:define>

<ui:define name="content">

<h:form id="fragment-group-form">
    <div id="fragment-group">
        <p:selectBooleanCheckbox id="checkbox-for-all-fragments" itemLabel="&nbsp;" widgetVar="fragmentCheckboxMaster" />
        <p:tooltip for="checkbox-for-all-fragments" value="Selects/unselects all fragments" />
	    <c:forEach var="fragmentBean" items="#{fragmentListBean.fragmentBeans}" varStatus="loop">
	        <ui:include src="each-fragment.xhtml" />
	    </c:forEach>
    </div>
</h:form>

</ui:define> <!-- end of content -->

<ui:define name="sidebar">
    <ui:include src="sidebar.xhtml"></ui:include>
</ui:define>

<ui:define name="test-area">
</ui:define>

<ui:define name="footer"><h5>This is Footer!!!</h5></ui:define>


</ui:composition>
