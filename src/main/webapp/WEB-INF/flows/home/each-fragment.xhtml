<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	>

<div class="each-fragment-container">
	<h:panelGrid styleClass="each-fragment" bgcolor="#eee" columns="1" border="1">
		<f:facet name="header">
			<div class="fragment-header">
				<p:selectBooleanCheckbox value="#{fragmentBean.checked}" itemLabel="&nbsp;#{fragmentBean.fragment.id}"
				    widgetVar="fragmentCheckboxSlave${panelId}_${loop.index}" />
				&nbsp;&nbsp;
				<p:commandLink value="#{fragmentBean.fragment.title} " action="inspect-fragment">
					<f:param name="fragmentLoopIndex" value="${loop.index}" />
					<f:param name="panelId" value="#{panelId}" />
				</p:commandLink>
				&nbsp;&nbsp;
                <c:forEach var="tag" items="#{fragmentBean.fragment.tags}">
                    <ui:include src="each-tag.xhtml" />
                </c:forEach>
				&nbsp;&nbsp;
				<h:outputText style="font-weight:lighter;" value="#{fragmentBean.fragment.updateDatetime}">
					<f:converter converterId="jodaDateTimeConverter" />
				</h:outputText>
				<div class="fragment-menu">
					<a href="#editor-frame" class="edit-fragment-editor-trigger button-link"
					   onclick="openFragmentEditorForEdit('#{panelId}', '#{fragmentBean.fragment.id}', '#{fragmentBean.concatenatedTagNames}')">
                        <span class="fa fa-pencil fa-3x" title="#{msg['label_edit_fragment']}"></span>
					</a>
					<c:choose>
						<c:when test="#{panelContext.fragmentDeletable}">
							<p:commandLink oncomplete="confirmTrashingFragments('#{panelId}', '#{fragmentBean.fragment.id}', true, false)" >
								<span class="fa fa-trash fa-3x button-link warning-color" title="#{msg['label_delete_fragment']}"></span>
							</p:commandLink>
						</c:when>
						<c:otherwise>
							<p:commandLink oncomplete="confirmTrashingFragments('#{panelId}', '#{fragmentBean.fragment.id}', false, false)" >
								<span class="fa fa-trash fa-3x button-link" title="#{msg['label_trash_fragment']}"></span>
							</p:commandLink>
						</c:otherwise>
					</c:choose>
					<h:inputHidden id="fragment-title-placeholder-panel#{panelId}-#{fragmentBean.fragment.id}" value="#{fragmentBean.fragment.title}" />
					<h:inputHidden id="fragment-content-placeholder-panel#{panelId}-#{fragmentBean.fragment.id}" value="#{fragmentBean.fragment.content}" />
				</div>
			</div>
		</f:facet>
		<h:outputText value="#{fragmentBean.fragment.content}" styleClass="fragment-content" />
	</h:panelGrid>
</div>

</ui:composition>