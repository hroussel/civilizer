<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	>
	
<script>
//<![CDATA[
$(document).ready(function() {
	var panels = [ $("#fragment-panel-0"), $("#fragment-panel-1"), $("#fragment-panel-2") ];
	panels[0].css({ width:'100%' });
	panels[1].hide();
	panels[2].hide();
}); // end of $(document).ready()

function onPanelActivationChange() {
	var buttons = PF("panelToggler").jq.find("input");
	var panels = [ $("#fragment-panel-0"), $("#fragment-panel-1"), $("#fragment-panel-2") ];
	var activeCount = 0;
	
	for (var i=0; i<3; ++i) {
		if (buttons.eq(i).prop("checked")) {
			++activeCount;
			panels[i].show();
			$("fragment-group-form\\:fragment-panel-toolbar-"+i).offset({
				left: panels[i].offset().left
			});
		}
		else {
			panels[i].hide();
		}
	}
	
	var w = '100%';
	switch (activeCount) {
	case 2:
		w = '45%';
		break;
	case 3: 
		w = '30%';
		break;
	}
	for (var i=0; i<3; ++i) {
		panels[i].css({ width: w });
	}
}
//]]>
</script>

<a href="home" class="button-link">
    <span id="app-title"> #{msg['application_name']} </span>
</a>

<a href="#editor-frame" id="new-fragment-editor-trigger" class="button-link new-resource-color" title="#{msg['label_new_fragment']}" >
    <span class="fa fa-plus-square fa-2x"></span>
</a>

<h:form style="display: inline; margin: 0; padding: 0; ">
    <span id="panel-activation-buttons" >
		<p:selectManyButton value="#{customParams.activePanels}" widgetVar="panelToggler" onchange="onPanelActivationChange();">
	        <f:selectItem itemLabel="#{msg['label_panel']} 0" itemValue="0" />
	        <f:selectItem itemLabel="#{msg['label_panel']} 1" itemValue="1" />
	        <f:selectItem itemLabel="#{msg['label_panel']} 2" itemValue="2" />
	    </p:selectManyButton>
    </span>
</h:form>

<ui:include src="/WEB-INF/flows/home/fragment-editor.xhtml" />

</ui:composition>