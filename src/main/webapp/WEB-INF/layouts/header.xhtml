<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	>
	
<script>
//<![CDATA[
$(document).ready(function() {
	$("#panel-activation-buttons").buttonset();

	var activeCount = 0;
	for (var i = 0; i < 3; i++) {
		if (sessionStorage.getItem('panel-' + i) === "on") {
			++activeCount;
		    $("#panel-toggler-" + i).prop("checked", true);
		}
	}
	if (activeCount === 0) {
	    $("#panel-toggler-0").prop("checked", true);
	}
	var idSpecifiedFromTagPalette = $("#fragment-group-form\\:id-placeholder-for-tag-palette-panel-radio").val();
	if (idSpecifiedFromTagPalette) {
		$("#panel-toggler-" + idSpecifiedFromTagPalette).prop("checked", true);
	}

	$("#panel-activation-buttons").buttonset("refresh");
	
	onPanelActivationChange();
}); // end of $(document).ready()

function onPanelActivationChange() {
	var panels = [ $("#fragment-panel-0"), $("#fragment-panel-1"), $("#fragment-panel-2") ];
	var activeCount = 0;
	
	for (var i=0; i<3; ++i) {
		if ($("#panel-toggler-" + i).prop("checked")) {
			++activeCount;
			panels[i].show();
			$("fragment-group-form\\:fragment-panel-toolbar-"+i).offset({
				left: panels[i].offset().left
			});
			sessionStorage.setItem('panel-' + i, 'on');
		}
		else {
			panels[i].hide();
			sessionStorage.setItem('panel-' + i, 'off');
		}
	}
	
	var w = '100%';
	switch (activeCount) {
	case 2:
		w = '45%';
		break;
	case 3: 
		w = '30%';
		break;
	}
	for (var i=0; i<3; ++i) {
		panels[i].css({ width: w });
	}
}
//]]>
</script>

<a href="home" class="button-link">
    <span id="app-title"> #{msg['application_name']} </span>
</a>

<a href="#editor-frame" id="new-fragment-editor-trigger" class="button-link new-resource-color" title="#{msg['label_new_fragment']}" >
    <span class="fa fa-plus-square fa-2x"></span>
</a>

<h:form style="display: inline; margin: 0; padding: 0; ">
    <span id="panel-activation-buttons" >
        <input type="checkbox" id="panel-toggler-0" style="display:none;" onchange="onPanelActivationChange();"/>
        <label for="panel-toggler-0" title="#{msg['toggle_panel']} 0">
            <span class="fa fa-file-text">&nbsp;#{msg['label_panel']} 0</span>
        </label>
        <input type="checkbox" id="panel-toggler-1" style="display:none;" onchange="onPanelActivationChange();"/>
        <label for="panel-toggler-1" title="#{msg['toggle_panel']} 1">
            <span class="fa fa-file-text">&nbsp;#{msg['label_panel']} 1</span>
        </label>
        <input type="checkbox" id="panel-toggler-2" style="display:none;" onchange="onPanelActivationChange();"/>
        <label for="panel-toggler-2" title="#{msg['toggle_panel']} 2">
            <span class="fa fa-file-text">&nbsp;#{msg['label_panel']} 2</span>
        </label>
    </span>
</h:form>

<div id="user-menu-area">
<h:form id="user-menu-form">
    <p:commandButton id="user-menu-trigger" value="Show" type="button" icon="ui-icon-extlink"/>
    <p:slideMenu id="user-menu" overlay="true" trigger="user-menu-trigger" my="left top" at="left bottom" style="width:200px">
        <p:submenu label="Ajax Menuitems">
            <p:menuitem value="Save" ajax="false" />
            <p:menuitem value="Update" ajax="false" />
        </p:submenu>
        <p:submenu label="Non-Ajax Menuitem">
            <p:menuitem value="Delete" ajax="false" />
        </p:submenu>
        <p:submenu label="Navigations" >
            <p:submenu label="Prime Links">
                <p:menuitem value="Prime" url="http://www.prime.com.tr" />
                <p:menuitem value="PrimeFaces" url="http://www.primefaces.org" />
            </p:submenu>
            <p:menuitem value="Mobile" outcome="/mobile/index" />
        </p:submenu>
    </p:slideMenu>
    
<!--     <p:menuButton value="Options"> -->
<!--         <p:menuitem value="Save" icon="ui-icon-disk"/> -->
<!--         <p:menuitem value="Update" icon="ui-icon-arrowrefresh-1-w"/> -->
<!--         <p:menuitem value="Delete" ajax="false" icon="ui-icon-close"/> -->
<!--         <p:separator /> -->
<!--         <p:menuitem value="Homepage" url="http://www.primefaces.org" icon="ui-icon-extlink"/> -->
<!--     </p:menuButton> -->
</h:form>
</div>

<ui:include src="/WEB-INF/flows/home/fragment-editor.xhtml" />

</ui:composition>