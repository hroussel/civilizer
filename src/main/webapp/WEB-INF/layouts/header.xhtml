<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	>

<span id="app-title"> #{msg['application_name']} </span>

<a href="#editor-frame" id='new-fragment-editor-trigger' title="New Fragment" >
	<img id="new-fragment-button" src="resources/styles/custom/images/add-fragment.png" />
</a>

<div style='display:none' >
    <div id='editor-frame' >
        <h:form id="fragment-editor-form"  >
	        <p:inputText id="title-input" value="#{fragmentBean.fragment.title}" autocomplete="false" />
	        <p:inputText id="tags-input" value="#{fragmentBean.tagNames}" autocomplete="false" />
	        <textarea id="fragment-content-editor" cols="80" rows="20"></textarea>
	        <h:inputHidden id="content-placeholder" value="#{fragmentBean.fragment.content}" />
	        <h:inputHidden id="id-placeholder" value="#{fragmentBean.fragment.id}" />
		    <p:commandButton onclick="prepareFragmentContent();" value="Preview" action="preview" />
		    <p:commandButton onclick="prepareFragmentContent();" value="Save" action="save" />
        </h:form>
    </div>
</div>

<script type="text/javascript">
	function prepareFragmentContent() {
		var editor = $("#fragment-content-editor");
	    var srcContent = editor.val();
	    $("#fragment-editor-form\\:content-placeholder").val(srcContent);
	}
</script>

</ui:composition>
